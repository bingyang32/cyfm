DROP TABLE IF EXISTS CY_SYS_USER_ROLE;

DROP TABLE IF EXISTS CY_SYS_ROLE;

DROP TABLE IF EXISTS CY_SYS_USER;

DROP TABLE IF EXISTS CY_SYS_TEAM;

DROP TABLE IF EXISTS CY_SYS_RESOURCE;

DROP TABLE IF EXISTS CY_SYS_USER_ONLINE;

DROP TABLE IF EXISTS CY_SYS_PERMISSION;

DROP TABLE IF EXISTS CY_SYS_ROLE_RESOURCE_PERMISSION;

DROP TABLE IF EXISTS CY_SYS_AUTHORIZE;


CREATE TABLE CY_SYS_ROLE (
  ID BIGINT GENERATED BY DEFAULT AS IDENTITY,
	NAME VARCHAR(255) NOT NULL UNIQUE,
	VALUE VARCHAR(255) NOT NULL UNIQUE,
	PERMISSIONS TEXT,
	DESCRIPTION TEXT,
PRIMARY KEY (ID)
);

CREATE TABLE CY_SYS_USER (
  ID BIGINT GENERATED BY DEFAULT AS IDENTITY,
  USERNAME VARCHAR(255) NOT NULL UNIQUE,
  NAME VARCHAR(64),
  PASSWORD VARCHAR(255),
  SALT VARCHAR(64),
  EMAIL VARCHAR(128),
  TEL VARCHAR (20) UNIQUE,
  STATUS VARCHAR(32),
  TEAM_ID BIGINT,
  CREATE_DATE DATETIME,
  DELETED INT DEFAULT 0,
  PRIMARY KEY (ID)
);

CREATE TABLE CY_SYS_USER_ROLE (
  USER_ID BIGINT NOT NULL,
  ROLE_ID BIGINT NOT NULL,
  PRIMARY KEY (USER_ID, ROLE_ID)
);

CREATE TABLE CY_SYS_TEAM (
  ID BIGINT GENERATED BY DEFAULT AS IDENTITY,
	NAME VARCHAR(255) NOT NULL UNIQUE,
	MASTER_ID BIGINT,
  PRIMARY KEY (ID)
);


CREATE TABLE CY_SYS_RESOURCE
(
  ID BIGINT GENERATED BY DEFAULT AS IDENTITY,
  NAME VARCHAR(255),
  ICON VARCHAR(255),
  _IDENTITY VARCHAR(255),
  PARENT_ID BIGINT,
  PARENT_IDS VARCHAR(255),
  URL VARCHAR(255),
  WEIGHT INT,
  IS_SHOW BIT,
  RESOURCE_TYPE INT,
  PRIMARY KEY (ID)
);

CREATE TABLE CY_SYS_USER_ONLINE
(
  ID VARCHAR(255),
  HOST VARCHAR(255),
  LAST_ACCESS_TIME DATETIME,
  ONLINE_SESSION LONGTEXT,
  START_TIMESTAMP DATETIME,
  STATUS VARCHAR(255),
  SYSTEM_HOST VARCHAR(255),
  TIMEOUT BIGINT,
  USER_AGENT VARCHAR(255),
  USER_ID BIGINT,
  USERNAME VARCHAR(255),
  PRIMARY KEY (ID)
);


CREATE TABLE CY_SYS_PERMISSION
(
    ID BIGINT(20) GENERATED BY DEFAULT AS IDENTITY,
    NAME VARCHAR(100) NOT NULL UNIQUE,
    VALUE VARCHAR(100) NOT NULL UNIQUE,
    DESCRIPTION TEXT
);

CREATE TABLE CY_SYS_ROLE_RESOURCE_PERMISSION(
  ID BIGINT GENERATED BY DEFAULT AS IDENTITY,
  ROLE_ID BIGINT,
  RESOURCE_ID BIGINT,
  PERMISSION_IDS VARCHAR(500),
);
alter table tablaname  add  constraint UNIQUE_SYS_ROLE_RESOURCE_PERMISSION UNIQUE(ROLE_ID, RESOURCE_ID);

CREATE TABLE CY_SYS_AUTHORIZE
(
    ID BIGINT GENERATED BY DEFAULT AS IDENTITY,
    USER_ID BIGINT NOT NULL,
    TARGET_ID BIGINT NOT NULL,
    AUTH_TYPE VARCHAR(50) NOT NULL
);
